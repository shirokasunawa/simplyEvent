
<!doctype html>
<html lang="fr">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<script src="util.js"></script>
<script src="./content/header.js"></script>
<script src="./content/footer.js"></script>

<body onload="testConnexion()">
<div id="header"></div>
 <script>
   setHeader()
     </script>
  
<script>


   let cookie= getCookie('nomuser')
  if( cookie=='' )
  {
    document.location.href = "index.html"
  }
  </script>
  </br>
 
    
     
     
<div id="Moncarousel"> </div>
<script>
setCarouselHTML()

</script>

 
      <div class="modal fade " id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body  " >
     
      <span id="PubModal"></span>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
 
     
   <div class="container-fluid" style="position : relative!important">
   
      <div class="row">
    
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
        
          <div class="sidebar-sticky" >
          
            <div class=" align-content-stretch">
              <span id="infoTitre"></span>
              
              <span id="infoBudget"></span>
              <span id="infoTypeEvent"></span>
              
              <span id="infoDate"></span>
              
            </div>
            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
              <span>Vos Actions</span>
            
              <diV class="d-flex align-items-center text-muted" >
   <svg class="svg" onclick="afficheChecklist()" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus-circle"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg>
               
              </diV>
            </h6>
            <ul class="nav flex-column mb-2">
             <!-- <li class="nav-item">
                <a class="nav-link" href="#">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                  Current month
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                  Last quarter
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                  Social engagement
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                  Year-end sale
                </a>
              </li>-->
              <span id="mesChecklists"></span>
            </ul>
          </div>
        </nav>

        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4"><div class="chartjs-size-monitor" style="position: absolute; inset: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
          <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
             <span id="typeEvents"></span>
            <div class="btn-toolbar mb-2 mb-md-0">
              <div class="btn-group mr-2">
               <!-- <button class="btn btn-sm btn-outline-secondary">Share</button>
                <button class="btn btn-sm btn-outline-secondary">Export</button>-->
                <button class="btn btn-sm btn btn-outline-danger" onclick="deleteEvent()" style="    border-color: #dc3545;">Supprimer <i class="bi bi-trash"></i></button>
              </div>
            <!--  <button class="btn btn-sm btn-outline-secondary dropdown-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                This week
              </button>-->
            </div>
          </div>
          
  <img src="./imgDefault.PNG" id="myimg" width="500" height="800" class="col-md-2 float-md-end mb-3 ms-md-3" alt="...">
          <span id="bodyTabBoard"> 

       
          </span>
         
      
        </main>
      </div>
    </div>
    
   <script>
// $('.dropdown-toggle').dropdown()
       var id=  localStorage.getItem("temporaryVarClicke")
    var url = 'http://'+urlDeploy+':3030/events/event/'+id;
    const xhr = new XMLHttpRequest()
    xhr.open('GET', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
            //console.log(res)
            
            localStorage.setItem("eventTitre",res["titreEvent"])
            localStorage.setItem("eventDate",res["dateEvent"])
            localStorage.setItem("eventBudget",res["budgetEvent"])
            localStorage.setItem("eventType",res["_typeEvent"]["libelle"])
            //localStorage.setItem("eventType",res["_typeEvent"])
            let objLinea = JSON.stringify(res["_checklists"]);
            localStorage.setItem("eventChecklist",res["objLinea"])
           
           var s = '<h1 class="h2">'+res['titreEvent']+'</h1>'
            document.getElementById("typeEvents").innerHTML = s
            var setTitre =''
        
            setTitre +='<div class="btn " style="width: 100%;margin-top:1em;" onclick="modifTitre()"> <div class=" d-inline p-2 justify-content-start"> Votre titre : </div><div class="d-inline p-2 justify-content-end">'+res['titreEvent']+'</div><div></div>'
 
       
            document.getElementById("infoTitre").innerHTML =setTitre
            var setBudget =''
      
            setBudget +='<div class="btn "   style="width: 100%; margin-top:1em;" onclick="modifBudget()" > <div class=" d-inline p-2 justify-content-start"> Votre Budget :</div><div class="d-inline p-2 justify-content-end"> '+res['budgetEvent']+' € </div><div></div>'

            document.getElementById("infoBudget").innerHTML =setBudget
            var settype =''
   
            settype +=' <div class="btn " style="width: 100%; margin-top:1em;" onclick="modifType()"> <div class=" d-inline p-2 justify-content-start">Catégorie : </div><div class="d-inline p-2 justify-content-end">'+res['_typeEvent']["libelle"]+'</div><div></div>'
  
            document.getElementById("infoTypeEvent").innerHTML =settype
            var setDate =''
       
            setDate +='<div class="btn " style="width: 100%; margin-top:1em;" onclick="modifDate()"> <div class=" d-inline p-2 justify-content-start">Date : </div><div class="d-inline p-2 justify-content-end">'+res['dateEvent']+' </div><div></div>'
    
            document.getElementById("infoDate").innerHTML =setDate
           
            if(res['_checklists'].length!=0)
            {
              var checklist='</br>'
              for(var t=0; t<res['_checklists'].length;t++){
                checklist+= '<div class="d-flex flex-row"><div class=" btn  p-2 justify-content-start" onclick="afficheDetailChecklist(\''+res['_checklists'][t]['_id']+'\')" style="width: 100%; ">'+res['_checklists'][t]['titreCheclist']+' </div><div class=" p-2 justify-content-end btn btn-outline-danger"  style="border-color: #dc3545;"><i class="bi bi-trash" onclick="removeChecklist(\''+res['_checklists'][t]['_id']+'\')"></i></div></div></br>'
              }
             // console.log(res['_checklists'])
              document.getElementById("mesChecklists").innerHTML = checklist
            }

        }
    };
    xhr.send()
function affichePubModal(){
  
  var url = 'http://'+urlDeploy+':3030/events/pubmodal/'
  

    const xhr = new XMLHttpRequest()
    xhr.open('GET', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
                
            var data=(res[0]["img"]["img"]).split(',')[1];
     var binaryBlob = atob(data);
    
     var s=' <img src="data:image/jpeg;base64,' + btoa(binaryBlob)+'" style="max-width: 100%" id="myimg" onclick="majClickPub(\''+res[0]["_id"]+'\',\''+res[0]["nbrClickReel"]+'\') " >'

document.getElementById("PubModal").innerHTML = s
           
            
        }
    };
    xhr.send()
}
function majClickPub(idPub,nbrclickReel)
{
 
  var nbrclick = nbrclickReel +1;
  
  var url = 'http://'+urlDeploy+':3030/events/pub/'+idPub;
  
  var body = {
                "nbrClickReel": nbrclick
               
              
                
            };
            const data = JSON.stringify(body)
    const xhr = new XMLHttpRequest()
    xhr.open('PUT', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
                
           
            $('#exampleModal').modal('hide');
        
        }
    };
    xhr.send(data)
}
function afficheDetailChecklist(idChecklist){
 
$("#exampleModal").modal('show');

  

  affichePubModal()
  console.log(idChecklist)
 
  var url = 'http://'+urlDeploy+':3030/events/checklist/'+idChecklist;

const xhr = new XMLHttpRequest()
 xhr.open('GET', url, true)
 xhr.setRequestHeader('content-type', 'application/json')
 xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
 xhr.responseType = "json"
 var res
 xhr.onreadystatechange = function () {
     if (this.readyState == 4 && this.status == 200) {
         res = xhr.response;
                   console.log(res)
      if((res.hasOwnProperty('productChecklist'))&&(res["productChecklist"] !=''))
      {
        afficheProductChoisis(res["productChecklist"],idChecklist)
      }
      else{
                    var s=''
            s+='<div class="row" style="height: 50%;">'
            s+=' <div class="form-group">'
          s+='<div class="form-group row">'
          s+='  <label for="PrixBudgetChecklist" class=" col-form-label">Indiquer le prix ou votre budget </label>'
          s+='  <div class="">'
          s+=' <input type="number" class="form-control" id="PrixBudgetChecklist" name="PrixBudgetChecklist"min="0" >'
          s+=' </div>'
          s+='</div></br>'
          s+='<div class="form-group row">'
          s+='  <label for="QuantityChecklist" class=" col-form-label">Indiquer la quantite</label>'
          s+='  <div class="">'
          s+=' <input type="number" class="form-control" id="QuantityChecklist" name="QuantityChecklist"min="0" >'
          s+=' </div>'
          s+='</div></br>'
          var titreButn= ''
        //check non présence d'informations 
                  if(res.hasOwnProperty('prixCheclist'))
                  {
                  
                  titreButn= 'Modifier'
                  
                  }
                  else{
                    titreButn= 'Ajouter'
                
                  
                  }
         s += ' <button style="background-color:#e685b5 ;  border-color:#e685b5" type="button" class="btn btn-primary"  onclick="ajoutInfoCheckist(\''+idChecklist+'\')">'+titreButn+'</button>';
         s+='</div>'
          s+='</div></br>'

          s+='<span id="viewDiv"></span>'

          document.getElementById("bodyTabBoard").innerHTML = s
                  if(res.hasOwnProperty('prixCheclist')){
                    document.getElementById("PrixBudgetChecklist").value = res["prixCheclist"]
                  document.getElementById("QuantityChecklist").value = res["quantiteCheclist"]
                      }
                   afficheProduit(idChecklist)
          }


     }
 };
 xhr.send()

}
function ajoutInfoCheckist(idchecklist){
 var PrixBudgetChecklist= document.getElementById("PrixBudgetChecklist").value
 var QuantityChecklist= document.getElementById("QuantityChecklist").value

  var url = 'http://'+urlDeploy+':3030/events/checklist/'+idchecklist;
  
  var body = {
                "prixCheclist": PrixBudgetChecklist,
                "quantiteCheclist": QuantityChecklist
              
                
            };
            const data = JSON.stringify(body)
    const xhr = new XMLHttpRequest()
    xhr.open('PUT', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
                
           
            document.location.reload();
            
        }
    };
    xhr.send(data)
}
function afficheProduit(idChecklist){
  var url = 'http://'+urlDeploy+':3030/events/society/';

           
    const xhr = new XMLHttpRequest()
    xhr.open('GET', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
            var string='';
            string+='<div class="row" style="height: 50%;">'
            for(var n=0;n<res.length;n++){

              if(res[n]["_products"].length !=0){
               string +='<div  >'
                string +=' <button   onclick="affichePush(\''+n+'\')" type="button" style="margin: 5px; width: 100%" class="btn-outline-primary btn-lg btn-block">'+res[n]["nameSociety"]+'</button>'
                string +=' <div  id="dropPush'+n+'" style=" display: none;" >'
                var productOneSociety=res[n]["_products"];
                for(var h=0;h<productOneSociety.length;h++)
                {
                  string +=' <button type="button" class="btn btn-light btn-lg btn-block" style="width:100%;text-align: left;" onclick="choixProduit(\''+productOneSociety[h]["_id"]+'\',\''+idChecklist+'\')">'+productOneSociety[h]["typeProduct"]+' Prix unitaire : '+productOneSociety[h]["priceProduct"]+'€</button></br>'
                }
               
                
                string +='</div>'
               
                string +='</div></br>'
          
              }
            }
            string+='</div>'
           document.getElementById("viewDiv").innerHTML = string
        }
    };
    xhr.send()
}
function choixProduit(idProduct,idChecklist){
//modifie checklist ajoute produit 
//met a jour l'affichage avec contacter le vendeur
//vérifier si click checklist a pas deja un produit

  var url = 'http://'+urlDeploy+':3030/events/checklist/'+idChecklist;

var body = {
              'productChecklist': idProduct
            
              
          };
          const data = JSON.stringify(body)
  const xhr = new XMLHttpRequest()
  xhr.open('PUT', url, true)
  xhr.setRequestHeader('content-type', 'application/json')
  xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
  xhr.responseType = "json"
  var res
  xhr.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
          res = xhr.response;
                    
          afficheProductChoisis(idProduct,idChecklist)
         
         // document.getElementById("viewDiv").innerHTML = string
      }
  };
  xhr.send(data)

  
}

function afficheProductChoisis(idProduct,idChecklist){
  console.log(idChecklist)
  var url = 'http://'+urlDeploy+':3030/events/product/'+idProduct;


  const xhr = new XMLHttpRequest()
  xhr.open('GET', url, true)
  xhr.setRequestHeader('content-type', 'application/json')
  xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
  xhr.responseType = "json"
  var res
  xhr.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
          res = xhr.response;
                    
         string =''
         string +='<h1>'+res["typeProduct"]+'</h1>'
         string +='<h1>'+res["priceProduct"]+'</h1>'
         string +='<button type="button" class="btn btn-primary"onclick="modifProductProduit(\''+idChecklist+'\')">Modifier</button>'
         string +='<button type="button" class="btn btn-primary">Contacter vendeur</button>'
         
         
         document.getElementById("bodyTabBoard").innerHTML = string
      }
  };
  xhr.send()
}
function modifProductProduit(idChecklist){
  console.log(idChecklist)
  var url = 'http://'+urlDeploy+':3030/events/checklistproduct/'+idChecklist;

  const xhr = new XMLHttpRequest()
  xhr.open('PUT', url, true)
  xhr.setRequestHeader('content-type', 'application/json')
  xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
  xhr.responseType = "json"
  var res
  xhr.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
          res = xhr.response;
                    
          //afficheProductChoisis(idProduct,idChecklist)
         document.location.reload();
         // document.getElementById("viewDiv").innerHTML = string
      }
  };
  xhr.send()
}
function affichePush(idElement){
  console.log(idElement)
  var name="dropPush"+idElement
  var statut= document.getElementById(name).style.display
  if(statut=='none')
  {
    document.getElementById(name).style.display='block'
  document.getElementById(name).style.overflow='hidden!important'
  document.getElementById(name).style.position='position: absolute!important'
  }
  else{
    document.getElementById(name).style.display='none'
  }
 
}
    function modifTitre(){
      var setBodyForm=''
      setBodyForm+=' <div class="d-flex justify-content-center">'
      setBodyForm+='<div class="form-signin">'
      setBodyForm+=' <div class="form-group row">'
      setBodyForm+=' <label for="titreEvent"  class="col-form-label">Modifier le titre à votre évènement</label>'
      setBodyForm+=' <div class="">'
      setBodyForm+='  <input type="text"   class="form-control" id="titreEvent" >'
      setBodyForm+=' </div>'
      setBodyForm+=' </div></br>'
      setBodyForm+=' <button class="btn " onclick="modifTitreBtn()">Modifier</button></div></div>'
      document.getElementById("bodyTabBoard").innerHTML = setBodyForm
     var titre = localStorage.getItem("eventTitre")
      document.getElementById("titreEvent").value = titre
    }

    function removeChecklist(idChecklist){
      console.log(idChecklist)
  var url = 'http://'+urlDeploy+':3030/events/checklist/'+idChecklist;

   const xhr = new XMLHttpRequest()
    xhr.open('DELETE', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
                      
            //localStorage.setItem("eventTitre",newDate)
            document.location.reload();
            
        }
    };
    xhr.send()
    }

    function deleteEvent(){
    
  var id=  localStorage.getItem("temporaryVarClicke")
  var url = 'http://'+urlDeploy+':3030/events/event/'+id;

    const xhr = new XMLHttpRequest()
    xhr.open('DELETE', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
                      
            //localStorage.setItem("eventTitre",newDate)
            document.location ="espacePrive.html";
            
        }
    };
    xhr.send()
    }

function modifTitreBtn(){
  var newDate = document.getElementById("titreEvent").value
  var id=  localStorage.getItem("temporaryVarClicke")
  var url = 'http://'+urlDeploy+':3030/events/event/'+id;

  var body = {
                'titreEvent': newDate
              
                
            };
            const data = JSON.stringify(body)
    const xhr = new XMLHttpRequest()
    xhr.open('PUT', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
                      
            localStorage.setItem("eventTitre",newDate)
            document.location.reload();
            
        }
    };
    xhr.send(data)
}
    function modifBudget(){
      var setBodyForm=''
      setBodyForm+=' <div class="d-flex justify-content-center">'
      setBodyForm+='<div class="form-signin">'
      setBodyForm+='<div class="form-group row">'
      setBodyForm+='  <label for="budgetEvent" class=" col-form-label">Modifier votre budget ?</label>'
      setBodyForm+='  <div class="">'
      setBodyForm+=' <input type="number" class="form-control" id="budgetEvent" name="budgetEvent"min="0" >'
      setBodyForm+=' </div>'
      setBodyForm+='</div></br>'
      setBodyForm+=' <button class="btn " onclick="modifBudgetBtn()">Modifier</button></div></div>'
      document.getElementById("bodyTabBoard").innerHTML = setBodyForm
      var budget = localStorage.getItem("eventBudget")
      document.getElementById("budgetEvent").value = budget
    }

    function modifBudgetBtn(){
      var newDate = document.getElementById("budgetEvent").value
  var id=  localStorage.getItem("temporaryVarClicke")
  var url = 'http://'+urlDeploy+':3030/events/event/'+id;

  var body = {
                'budgetEvent': newDate
              
                
            };
            const data = JSON.stringify(body)
    const xhr = new XMLHttpRequest()
    xhr.open('PUT', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
                      
            localStorage.setItem("eventBudget",newDate)
            document.location.reload();
            
        }
    };
    xhr.send(data)
    }

function modifType(){
  var url = 'http://'+urlDeploy+':3030/events/typeEvents/';
    const xhr = new XMLHttpRequest()
    xhr.open('GET', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
            console.log(res)
            var setBodyForm=''
            setBodyForm+=' <div class="d-flex justify-content-center">'
            setBodyForm+='<div class="form-signin">'
            setBodyForm+='<div class="form-group row">'
            setBodyForm +=' <label for="typeProduit" class=" col-form-label">Modifier le type du produit</label>'
            setBodyForm +='  <div class="">'
            setBodyForm +='   <select class="form-select"id="typeProduit" >'
            
            for(var i=0;i<res.length;i++){
              setBodyForm += '<option  value=\''+res[i]["_id"]+'\'>'+res[i]["libelle"]+'</option>'
            }
            setBodyForm +='   </select>'
         
            setBodyForm+=' </div>'
            setBodyForm+='</div></br>'
            setBodyForm+=' <button class="btn " onclick="modifTypeBtn()">Modifier</button></div></div>'
            document.getElementById("bodyTabBoard").innerHTML = setBodyForm
           
      
            
        }
    };
    xhr.send()
}
function modifTypeBtn(){
 var newType = document.getElementById("typeProduit").value
  console.log(newType)
  var id=  localStorage.getItem("temporaryVarClicke")
  //console.log(id)
  var url = 'http://'+urlDeploy+':3030/events/typeEvents/'+newType+'/'+id;
//console.log(url)
 
          
          
    const xhr = new XMLHttpRequest()
    xhr.open('POST', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 201) {
            res = xhr.response;
                      
           // localStorage.setItem("eventDate",newDate)
           document.location.reload();
            
        }
    };
    xhr.send()
}

function modifDate(){
          var setBodyForm=''
          setBodyForm+=' <div class="d-flex justify-content-center">'
          setBodyForm+='<div class="form-signin">'
          setBodyForm+='<div class="form-group row">'
          setBodyForm+=' <label for="dateEvent" class=" col-form-label">Modifier la date de votre évènement</label>'
          setBodyForm+=' <div class="">'
          setBodyForm+=' <input type="date" class="form-control" id="dateEvent" name="dateEvent" min="0" >'
          setBodyForm+='  </div>'
          setBodyForm+='</div></br>'
          setBodyForm+=' <button class="btn " onclick="modifEventDate()">Modifier</button></div></div>'
          document.getElementById("bodyTabBoard").innerHTML = setBodyForm
          var budget = localStorage.getItem("eventDate")
      document.getElementById("dateEvent").value = budget
         
}
function modifEventDate(){
  var newDate = document.getElementById("dateEvent").value
  var id=  localStorage.getItem("temporaryVarClicke")
  var url = 'http://'+urlDeploy+':3030/events/event/'+id;

  var body = {
                'dateEvent': newDate
              
                
            };
            const data = JSON.stringify(body)
    const xhr = new XMLHttpRequest()
    xhr.open('PUT', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
                      
            localStorage.setItem("eventDate",newDate)
            document.location.reload();
            
        }
    };
    xhr.send(data)
}

function afficheChecklist(){
  var url = 'http://'+urlDeploy+':3030/events/typeActions/';
    const xhr = new XMLHttpRequest()
    xhr.open('GET', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhr.response;
           
            var setBodyForm=''
            var typeEvent = localStorage.getItem("eventType")
            for(var i=0;i<res.length;i++){
 
                for(var k=0;k<res[i]["_typeEvent"].length;k++){
                  if(res[i]["_typeEvent"][k]["libelle"]==typeEvent)
                  {
                   
                    setBodyForm += '<div class="d-flex flex-row"><div class="d-flex " style="padding-top: 15px;"><i  style=" font-size:22px !important;  " onclick="addChecklist(\''+res[i]["titreAction"]+'\')" class="bi bi-plus-circle svgg"></i></div><div class="btn d-flex justify-content-center" style="margin-top:1em;margin-bottom:1em;width:100%;text-align: center; margin-left:1em" >  '+res[i]["titreAction"]+'</div></div>'
                  }
                
                }
            
             
            }
            
            document.getElementById("bodyTabBoard").innerHTML = setBodyForm
            
      
            
        }
    };
    xhr.send()
}

function addChecklist(titreAction){
  //Create checklist 
  //assign checklist reload
  var id=  localStorage.getItem("temporaryVarClicke")
  var body = {
                "titreCheclist": titreAction
     
            };
            const data = JSON.stringify(body)
  var url = 'http://'+urlDeploy+':3030/events/checklist/';
    const xhr = new XMLHttpRequest()
    xhr.open('POST', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 201) {
            res = xhr.response;
            localStorage.setItem("idChecklist",res["_id"])
          assignChecklist()
            
        }
    };
    xhr.send(data)
}

function assignChecklist(){
  console.log(idCheclistAAssign)
  var idCheclistAAssign = localStorage.getItem("idChecklist")
  var id=  localStorage.getItem("temporaryVarClicke")
  var url = 'http://'+urlDeploy+':3030/events/checklist/'+idCheclistAAssign+'/'+id;
  const xhr = new XMLHttpRequest()
    xhr.open('POST', url, true)
    xhr.setRequestHeader('content-type', 'application/json')
    xhr.setRequestHeader('authorization', 'Bearer 123abc456def')
    xhr.responseType = "json"
    var res
    xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 201) {
            res = xhr.response;
            document.location.reload();
            
        }
    };
    xhr.send()
}

var urler = 'http://'+urlDeploy+':3030/events/pubcote';
  const xhrf = new XMLHttpRequest()
  xhrf.open('GET', urler, true)
  xhrf.setRequestHeader('content-type', 'application/json')
  xhrf.setRequestHeader('authorization', 'Bearer 123abc456def')
  xhrf.responseType = "json"
    var res
    xhrf.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            res = xhrf.response;
            console.log(res)
            var data=(res[0]["img"]["img"]).split(',')[1];
     var binaryBlob = atob(data);
    

var myimg= document.getElementById("myimg")
myimg.src = 'data:image/jpeg;base64,' + btoa(binaryBlob);
            
        }
    };
    xhrf.send()
    </script>
    <style>
       .btn {
        border-width: 2px;
        border-color: #ffeecc;

}
    .btn:hover {
      background-color: #ffeecc;

}
.svg:hover {
      background-color: #ffeecc;
      cursor: pointer;
      border-radius: 15px;

}
.svgg:hover {
      background-color: #ffeecc;
      cursor: pointer;
      border-radius: 15px;
      height: 27px   
    
}
    </style>
  <div id="footer"></div>
<script>
  setFooter()
  </script>
</body>
</html>